
<div class="container my-5" *ngIf="!loading && product; else loadingTpl">
<nav aria-label="breadcrumb" class="mb-3">
<ol class="breadcrumb bg-white p-0">
<li class="breadcrumb-item"><a href="#">Home</a></li>
<li class="breadcrumb-item text-capitalize"><a [routerLink]="['/category',product.category]">{{product.category}}</a></li>
<li class="breadcrumb-item active" aria-current="page">{{product.title}}</li>
</ol>
</nav>


<div class="row g-5" >
<!-- Image Gallery -->
<div class="col-md-6 d-flex flex-column align-items-center" >
<img
       [src]="selectedImage"
       class="img-fluid rounded shadow-md mb-2"
       style="max-height:500px"
       [alt]="product.title"
     />
<div class="d-flex gap-2 mt-2 ">
<img
         *ngFor="let img of product.images"
         [src]="img"
         class="img-thumbnail "
         [class.border-container]="selectedImage === img"
         [style.background]="'#eee'"
         style="width:80px; height:80px; object-fit:cover; cursor:pointer; border:1px solid #0078ad"
         (click)="selectImage(img)"
         [alt]="product.title + ' thumbnail'"
       />
</div>


</div>





<!-- Product Info & Actions -->


<div class="col-md-6  pe-3 "  >
<h3 class=" mb-1  fw-bold text-muted">{{ product.title }}</h3>
<div class="mb-2">
<small class="text-muted" *ngIf="product.brand">{{ product.brand }}</small>
<span class="badge ms-2"
             [ngClass]="product.stock > 0 ? 'bg-success' : 'bg-danger'">
         {{ product.stock > 0 ? 'In Stock' : 'Out of Stock' }}
</span>
</div>
<div class="h1 text-dark fw-bold mb-3">
<!-- &#8377;-->
 ${{ product.price | number }} 
</div>
<p class="mb-3 text-muted">{{ product.description }}</p>


<!-- Cart Actions Block -->
<div class="mb-3">
<!-- Quantity Buttons or Add to Cart -->
<div *ngIf="quantityAdded === 0" class="action-buttons-container">
  <button class="btn cts rounded-pill action-button" (click)="addToCart()"
  [disabled]="product.stock<1">
       <svg style="padding-bottom: 3px;" xmlns="http://www.w3.org/2000/svg" width="17" height="17" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
    <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
  </svg> Add to Cart  
  </button>


</div>

<div *ngIf="product.stock<1">
  <p class="text-danger mb-0">Out Of Stock!</p>
</div>

<div *ngIf="quantityAdded > 0" class="d-flex align-items-center justify-content-between gap-3">
  <div class="quantity-controls">
    <button class="btn btn-outline-danger" (click)="decreaseQty()">-</button>
    <span class="quantity-display">{{quantityAdded}}</span>
    <button class="btn btn-outline-success"
             (click)="increaseQty()"
             [disabled]="quantityAdded >= product.stock">+</button>
  </div>
  
  <!-- Go to Cart Button (same style/icon as Add to Cart) -->
  <button class="btn cts rounded-pill action-button d-flex align-items-center" [routerLink]="['/cart']">
    <svg style="padding-bottom: 3px;" xmlns="http://www.w3.org/2000/svg" width="17" height="17" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
      <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
    </svg>
    <span class="ms-2">Go to Cart</span>
  </button>

</div>

<!-- In Stock Info -->
<div *ngIf="product.stock <=10"><p class="text-danger mb-0">Only {{product.stock}} items left!</p></div>

<div class="position-fixed bottom-0 end-0 p-3" style="z-index:1055">
  <div #toastElem class="toast align-items-center text-bg-success opacity-100 text-white border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        Product Added to Cart! 
      </div>
    </div>
  </div>
</div>
</div>

<div class="mt-4">
<h5 class="mb-2">Specifications</h5>



<ul class="list-group border-0">
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.brand">
<span class="text-muted">Brand:</span> {{ product.brand }}
</li>
<!-- <li class="list-group-item border-0 ps-0 py-1" *ngIf="product.sku">
<span class="text-muted">SKU:</span> {{ product.sku }}
</li> -->
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.weight">
<span class="text-muted">Weight:</span> {{ product.weight }} g
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.dimensions">
<span class="text-muted">Dimensions:</span>
   {{ product.dimensions.width }}×{{ product.dimensions.height }}×{{ product.dimensions.depth }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.warrantyInformation">
<span class="text-muted">Warranty:</span> {{ product.warrantyInformation }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.shippingInformation">
<span class="text-muted">Shipping:</span> {{ product.shippingInformation }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.availabilityStatus">
<span class="text-muted">Availability:</span> {{ product.availabilityStatus }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.returnPolicy">
<span class="text-muted">Return Policy:</span> {{ product.returnPolicy }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.stock !== undefined && product.stock !== null">
<span class="text-muted">Stock:</span> {{ product.stock }}
</li>
<li class="list-group-item border-0 ps-0 py-1" *ngIf="product.category">
<span class="text-muted">Category:</span> {{ product.category }}
</li>
</ul>



</div>
<hr>


<div class="mt-4">
<h5 class="mb-2">Customer Reviews</h5>

<!-- <pre>{{product.reviews | json}}</pre> -->

<div *ngIf="product.reviews && product.reviews.length; else noReview">
<div *ngFor="let rev of product.reviews" class="mb-2 pb-2 border-bottom">
<b>{{ rev.reviewerName }}</b>
<span class="text-warning ms-1">
<ng-container *ngFor="let s of [].constructor(rev.rating)">&#9733;</ng-container>
</span>
<small class="text-muted ms-2">{{ rev.date | date:'mediumDate' }}</small>
<div class="text-muted">{{ rev.comment }}</div>
</div>
</div>
</div>


<ng-template #noReview>
<div class="text-muted">No reviews yet. Be the first!</div>
</ng-template>
</div>
</div>
<hr class="my-5">
  
  <app-similar-products
    *ngIf="product"    [category]="product.category"   [excludeProductId]="product.id">  </app-similar-products>
</div>


<ng-template #loadingTpl>
<div class="text-center p-5 mt-5">
<div class="spinner-border text-primary"></div>
<div class="mt-3">Loading product details...</div>
</div>
</ng-template>